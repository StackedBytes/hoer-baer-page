{% assign primary_screenshot = "" %}
{% assign has_video = false %}

{% for file in site.static_files %}
	{% if file.path contains "assets/screenshot/" and (file.name == "hero-de-0.png" or file.name == "hero-de-0.jpg") %}
		{% assign primary_screenshot = file.path %}
		{% break %}
	{% endif %}
{% endfor %}

{% for file in site.static_files %}
	{% if file.path contains "assets/screenshot/" and primary_screenshot == "" %}
		{% assign primary_screenshot = file.path %}
	{% endif %}
	{% if file.path contains "assets/videos/" %}
		{% if file.extname == ".mp4" or file.extname == ".mov" or file.extname == ".webm" or file.extname == ".ogg" %}
			{% assign has_video = true %}
		{% endif %}
	{% endif %}
{% endfor %}

<script>
$(function() {
	var $screenImage = $(".iphoneScreen");
	var $videoContainer = $(".videoContainer");
	var $video = $(".screenvideo");

	{% if has_video %}
		$screenImage.addClass("hidden");
		$videoContainer.removeClass("hidden");

		{% for file in site.static_files %}
			{% if file.path contains "assets/videos/" and (file.extname == ".mp4" or file.extname == ".mov") %}
				$video.append('<source src="{{ file.path | relative_url }}" type="video/mp4">');
			{% endif %}
		{% endfor %}

		{% for file in site.static_files %}
			{% if file.path contains "assets/videos/" and file.extname == ".webm" %}
				$video.append('<source src="{{ file.path | relative_url }}" type="video/webm">');
			{% endif %}
		{% endfor %}

		{% for file in site.static_files %}
			{% if file.path contains "assets/videos/" and file.extname == ".ogg" %}
				$video.append('<source src="{{ file.path | relative_url }}" type="video/ogg">');
			{% endif %}
		{% endfor %}

		if ($video.find("source").length > 0) {
			$video.get(0).load();
		}
	{% elsif primary_screenshot != "" %}
		$videoContainer.addClass("hidden");
		$screenImage.attr("src", "{{ primary_screenshot | relative_url }}");
		$screenImage.removeClass("hidden");
	{% endif %}
});
</script>
